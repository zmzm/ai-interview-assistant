{
  "track": "backend",
  "blocks": [
    {
      "id": "warmup",
      "title": "Warm-up & Context Calibration",
      "timeRange": "0–5",
      "duration": "5m",
      "goal": "Понять масштаб систем, уровень ответственности кандидата и контекст продакшена (нагрузка/критичность/домен).",
      "questions": [
        {
          "id": "be-warmup-1",
          "text": {
            "en": "Tell me briefly about your last system: scale, team size, and your role.",
            "ru": "Кратко расскажи про последнюю систему: масштаб, команда и твоя роль."
          },
          "prompts": [
            "Какая была нагрузка/критичность и тип отказов?",
            "За что ты отвечал end-to-end?",
            "Какие 1–2 решения ты реально продавливал?"
          ],
          "expectedDirection": "- Даёт продакшен-контекст.\n- Обозначает ownership.\n- Помогает выбрать глубину в следующих блоках."
        }
      ]
    },
    {
      "id": "architecture_nest",
      "title": "Backend Architecture & NestJS (CORE)",
      "timeRange": "5–15",
      "duration": "10m",
      "goal": "Понять архитектурное мышление и владение NestJS как framework’ом (модули, DI, пайплайн запроса).",
      "questions": [
        {
          "id": "be-1",
          "text": {
            "en": "How do you structure a backend service so it stays maintainable as the codebase and team grow?",
            "ru": "Как ты структурируешь backend-сервис, чтобы он оставался поддерживаемым при росте кода и команды?"
          },
          "prompts": [
            "Какие слои выделяешь и какие зависимости допустимы?",
            "Где проводишь границы модулей/доменов и почему?",
            "Какое архитектурное решение со временем оказалось ошибочным?"
          ],
          "expectedDirection": "- Говорит про boundaries/cohesion/coupling и ownership модулей.\n- Разделяет transport/app/domain/infra (или аналогично).\n- Понимает деградацию архитектуры и рефакторинг."
        },
        {
          "id": "be-2",
          "text": {
            "en": "How do you design configuration management so it’s safe, testable, and consistent across environments?",
            "ru": "Как ты строишь конфигурацию, чтобы было безопасно, тестируемо и консистентно между окружениями?"
          },
          "prompts": [
            "Как валидируешь конфиг на старте (типы/обязательность/диапазоны)?",
            "Как управляешь секретами на разных окружениях?",
            "Как избегаешь кейсов «на стейдже работает, на проде — нет»?"
          ],
          "expectedDirection": "- Централизует конфиг, валидирует fail-fast.\n- Отделяет secrets от config.\n- Думает принципами (immutable config, safe defaults)."
        },
        {
          "id": "be-3",
          "text": {
            "en": "How do you structure NestJS modules and providers so the app doesn’t become a “god module”?",
            "ru": "Как ты структурируешь модули и провайдеры в NestJS, чтобы приложение не превратилось в “god module”?"
          },
          "prompts": [
            "Как решаешь: модуль vs провайдер vs shared-библиотека?",
            "Как предотвращаешь circular dependencies?",
            "Когда используешь request-scope и какие риски?"
          ],
          "expectedDirection": "- Понимает модульность как boundaries.\n- Умеет объяснить exports/imports и публичные контракты модулей.\n- Осознаёт стоимость request-scoped и проблему циклов."
        },
        {
          "id": "be-4",
          "text": {
            "en": "How do you design cross-cutting concerns in NestJS (auth, validation, logging, tracing) without scattering code?",
            "ru": "Как ты проектируешь кросс-срезовые вещи в NestJS (auth, валидация, логирование, трейсинг), чтобы не размазывать код?"
          },
          "prompts": [
            "Где делаешь валидацию/трансформацию и почему?",
            "Как стандартизируешь формат ошибок?",
            "Как организуешь request-id/correlation-id?"
          ],
          "expectedDirection": "- Разносит concerns по pipes/guards/interceptors/filters.\n- Делает единый error contract.\n- Думает про трассировку и структурные логи."
        },
        {
  "id": "be-nest-di-container",
  "text": {
    "en": "How does the dependency injection container work in NestJS?",
    "ru": "Как работает DI-контейнер в NestJS?"
  },
  "prompts": [
    "Когда строится dependency graph?",
    "Что такое inversion of control?",
    "Как контейнер управляет жизненным циклом?"
  ],
  "expectedDirection": "- Dependency graph строится при старте.\n- Используется constructor injection.\n- Контейнер управляет lifecycle.\n- IoC как базовый принцип."
},
        {
  "id": "be-nest-scopes",
  "text": {
    "en": "What provider scopes exist in NestJS and when should they be used?",
    "ru": "Какие бывают scopes в NestJS и когда их использовать?"
  },
  "prompts": [
    "Почему REQUEST scope используется редко?",
    "В чём стоимость TRANSIENT?",
    "Какие проблемы с производительностью?"
  ],
  "expectedDirection": "- DEFAULT (singleton) — основной.\n- REQUEST — редко, из-за perf.\n- TRANSIENT — новый инстанс на инъекцию.\n- Понимание trade-offs."
}
      ]
    },
    {
      "id": "runtime_load",
      "title": "Async, Load & Runtime",
      "timeRange": "15–25",
      "duration": "10m",
      "goal": "Отделить “Node.js developer” от backend engineer: поведение под нагрузкой, backpressure, каскадные отказы.",
      "questions": [
        {
          "id": "be-7",
          "text": {
            "en": "Tell me about a production issue where the Node.js event loop became a bottleneck.",
            "ru": "Расскажи про продакшен-кейс, где event loop в Node.js стал узким местом."
          },
          "prompts": [
            "Это было CPU-bound или блокирующий I/O?",
            "Как вы это обнаружили (метрики/тулзы)?",
            "Что сделали, чтобы проблема не повторялась?"
          ],
          "expectedDirection": "- Понимает single-thread модель и ограничения.\n- Отличает CPU vs I/O.\n- Упоминает event loop delay/long tasks и поведение под load."
        },
        {
          "id": "be-8",
          "text": {
            "en": "How does your service behave under load when downstream systems become slow?",
            "ru": "Как ведёт себя сервис под нагрузкой, если зависимые системы начинают тормозить?"
          },
          "prompts": [
            "Что происходит с входящими запросами при деградации зависимостей?",
            "Как применяешь backpressure/rate limiting?",
            "Как предотвращаешь cascading failures?"
          ],
          "expectedDirection": "- Думает про таймауты/лимиты/очереди.\n- Понимает каскадные отказы.\n- Говорит про graceful degradation."
        },
        {
  "id": "be-nest-lifecycle-hooks",
  "text": {
    "en": "Why does NestJS provide lifecycle hooks?",
    "ru": "Зачем в NestJS нужны lifecycle hooks?"
  },
  "prompts": [
    "Где инициализируются ресурсы?",
    "Как реализовать graceful shutdown?",
    "Какие хуки ты реально использовал?"
  ],
  "expectedDirection": "- Инициализация ресурсов.\n- Корректное закрытие соединений.\n- onModuleInit / beforeApplicationShutdown.\n- Продакшен-контекст."
}
      ]
    },
    {
      "id": "data_reliability",
      "title": "Data, Consistency & Reliability",
      "timeRange": "25–35",
      "duration": "10m",
      "goal": "Проверить зрелость работы с данными и отказами: транзакции, eventual consistency, миграции, lifecycle процесса.",
      "questions": [
        {
          "id": "be-9",
          "text": {
            "en": "How do you ensure data consistency when multiple operations must succeed together?",
            "ru": "Как ты обеспечиваешь консистентность данных, когда несколько операций должны выполниться вместе?"
          },
          "prompts": [
            "Когда используешь транзакции базы, а когда нет?",
            "Какие race conditions встречал?",
            "Как обеспечиваешь консистентность между таблицами/сервисами?"
          ],
          "expectedDirection": "- Понимает ACID vs eventual consistency.\n- Осознанно применяет транзакции.\n- Знает про race conditions/lost updates."
        },
        {
          "id": "be-10",
          "text": {
            "en": "How do you handle workflows that span multiple services or systems?",
            "ru": "Как ты реализуешь бизнес-процессы, затрагивающие несколько сервисов или систем?"
          },
          "prompts": [
            "Использовал ли saga/outbox? Где и почему?",
            "Как восстанавливаешься после partial failures?",
            "Как избегаете double processing?"
          ],
          "expectedDirection": "- Понимает ограничения distributed systems.\n- Мыслит at-least-once delivery и компенсациями.\n- Не предлагает “2PC везде”."
        },
        {
          "id": "be-11",
          "text": {
            "en": "How do you evolve a database schema in a live system without downtime?",
            "ru": "Как ты меняешь схему базы данных в живой системе без даунтайма?"
          },
          "prompts": [
            "Как обеспечиваешь backward compatibility во время миграции?",
            "Какая миграция была самой болезненной?",
            "Как делаешь безопасный rollback?"
          ],
          "expectedDirection": "- Понимает zero-downtime migrations.\n- Использует additive changes.\n- Осознаёт, что rollback часто сложнее deploy."
        },
        {
          "id": "be-12",
          "text": {
            "en": "How do you design error handling so failures are predictable and manageable?",
            "ru": "Как ты проектируешь обработку ошибок, чтобы отказы были предсказуемыми и управляемыми?"
          },
          "prompts": [
            "Какие ошибки должны валить процесс, а какие — нет?",
            "Как классифицируешь ошибки и пробрасываешь наружу?",
            "Как клиент понимает, что можно ретраить?"
          ],
          "expectedDirection": "- Делит ошибки на recoverable/non-recoverable.\n- Понимает fail-fast vs graceful degradation.\n- Проектирует error contracts и retry-семантику."
        },
        {
          "id": "be-13",
          "text": {
            "en": "How do you shut down a Node.js service gracefully in production?",
            "ru": "Как ты корректно останавливаешь Node.js сервис в продакшене?"
          },
          "prompts": [
            "Как перестаёшь принимать новые запросы?",
            "Что делаешь с in-flight запросами?",
            "Как учитываешь балансировщик/оркестратор?"
          ],
          "expectedDirection": "- Знает SIGTERM/SIGINT.\n- Корректно дренит запросы.\n- Учитывает таймауты и дедлайны."
        },
        {
  "id": "be-db-index-performance",
  "text": {
    "en": "When can a database index hurt performance?",
    "ru": "Когда индекс в базе данных может ухудшить производительность?"
  },
  "prompts": [
    "Что происходит с write-heavy таблицами?",
    "Что такое low selectivity?",
    "Почему лишние индексы опасны?"
  ],
  "expectedDirection": "- Write-heavy workload.\n- Низкая селективность.\n- Неправильный порядок колонок.\n- Лишние индексы замедляют записи."
}
      ]
    },
    {
      "id": "api_security",
      "title": "API Design, Security & Contracts",
      "timeRange": "35–45",
      "duration": "10m",
      "goal": "Понять, как кандидат проектирует контракты, устойчивость к ретраям и безопасность как процесс.",
      "questions": [
        {
          "id": "be-5",
          "text": {
            "en": "How do you design an HTTP API contract so it stays stable as the product evolves?",
            "ru": "Как ты проектируешь контракт HTTP API, чтобы он оставался стабильным при развитии продукта?"
          },
          "prompts": [
            "Как решаешь versioning и backward compatibility?",
            "Как стандартизируешь list endpoints (пагинация/фильтры/сортировка)?",
            "Как поддерживаешь единый формат ошибок?"
          ],
          "expectedDirection": "- Мыслит контрактами и совместимостью.\n- Умеет объяснить versioning когда нужен/не нужен.\n- Держит единый error model (коды/типы/trace-id)."
        },
        {
          "id": "be-6",
          "text": {
            "en": "How do you make write operations safe to retry (idempotency) in real systems?",
            "ru": "Как ты делаешь операции записи безопасными для повторов (идемпотентными) в реальных системах?"
          },
          "prompts": [
            "Какие операции обязаны быть идемпотентными и почему?",
            "Как реализуешь idempotency key (хранение/TTL/unique constraints)?",
            "Что ломается при ретраях из-за таймаутов?"
          ],
          "expectedDirection": "- Понимает, что timeouts ≠ failure.\n- Проектирует идемпотентность на уровне API+storage.\n- Учитывает дубли/at-least-once и дедупликацию."
        },
        {
          "id": "be-15",
          "text": {
            "en": "Tell me about a real security issue you encountered in a backend system.",
            "ru": "Расскажи про реальный security-инцидент или уязвимость в backend-системе."
          },
          "prompts": [
            "Как это обнаружили (аудит/инцидент/репорт)?",
            "Какой был реальный риск/импакт?",
            "Что изменили, чтобы не повторилось?"
          ],
          "expectedDirection": "- Мыслит угрозами и последствиями.\n- Понимает attack surface.\n- Говорит про trade-offs (security vs UX/perf).\n- Security как процесс."
        },
        {
          "id": "be-16",
          "text": {
            "en": "How do you design authentication and authorization so it stays maintainable as the system grows?",
            "ru": "Как ты проектируешь аутентификацию и авторизацию, чтобы они масштабировались вместе с системой?"
          },
          "prompts": [
            "Как разделяешь authentication и authorization?",
            "RBAC/ABAC/policy-based — когда что выбираешь?",
            "Что ломалось при росте сложности правил доступа?"
          ],
          "expectedDirection": "- Разделяет identity и access control.\n- Умеет объяснить подходы RBAC/ABAC.\n- Думает о тестируемости и прозрачности правил."
        },
        {
  "id": "be-grpc-vs-rest",
  "text": {
    "en": "Why did you choose gRPC over REST?",
    "ru": "Почему вы выбрали gRPC, а не REST?"
  },
  "prompts": [
    "Какие преимущества даёт бинарный протокол?",
    "Почему важны строгие контракты?",
    "Где gRPC не подходит?"
  ],
  "expectedDirection": "- Бинарный протокол.\n- Строгие контракты.\n- Low latency.\n- Используется для internal service-to-service."
}
      ]
    },
    {
      "id": "production_testing",
      "title": "Production, Testing & Incidents",
      "timeRange": "45–55",
      "duration": "10m",
      "goal": "Подтвердить Senior через продакшен-опыт: observability, тестирование как инструмент уверенности, инциденты и постмортемы.",
      "questions": [
        {
          "id": "be-14",
          "text": {
            "en": "How do you design observability so you can debug production issues quickly?",
            "ru": "Как ты строишь observability, чтобы быстро разбираться с продакшен-проблемами?"
          },
          "prompts": [
            "Что логируешь, а что принципиально не логируешь?",
            "Какие 3–5 метрик критичны для сервиса?",
            "Как используешь trace/correlation IDs?"
          ],
          "expectedDirection": "- Структурированные логи.\n- Понимание latency/error rate/saturation.\n- Трейсы и correlation ids.\n- Мышление прод-отладкой."
        },
        {
          "id": "be-17",
          "text": {
            "en": "How do you decide what to test at unit, integration, and end-to-end levels?",
            "ru": "Как ты решаешь, что тестировать на уровне unit, integration и e2e?"
          },
          "prompts": [
            "Что слишком дорого или бесполезно тестировать?",
            "Как тесты влияют на скорость рефакторинга?",
            "Как тестируешь failure scenarios?"
          ],
          "expectedDirection": "- Чётко различает уровни тестирования.\n- Фокусируется на рисках.\n- Не пытается покрыть всё.\n- Тесты как уверенность, не отчётность."
        },
        {
          "id": "be-18",
          "text": {
            "en": "Tell me about a production incident you were responsible for.",
            "ru": "Расскажи про продакшен-инцидент, за который ты нёс ответственность."
          },
          "prompts": [
            "В чём была root cause, а не симптомы?",
            "Как вы митигировали ущерб?",
            "Что изменили после постмортема?"
          ],
          "expectedDirection": "- Берёт ответственность.\n- Говорит про root cause.\n- Делает системные улучшения.\n- Понимает ценность postmortems."
        }
      ]
    },
    {
      "id": "wrapup",
      "title": "Wrap-up",
      "timeRange": "55–60",
      "duration": "5m",
      "goal": "Дать кандидату задать вопросы и собрать финальные сигналы зрелости.",
      "questions": [
        {
          "id": "be-wrapup-1",
          "text": {
            "en": "Do you have any questions for us or about the system?",
            "ru": "Есть ли у тебя вопросы к нам или к системе/проекту?"
          },
          "prompts": [
            "Что тебе важно узнать про продакшен и процессы?",
            "Какие ограничения/долг/риски тебя интересуют?",
            "Какие ожидания от роли ты хочешь прояснить?"
          ],
          "expectedDirection": "- Вопросы про продакшен, процессы и ограничения.\n- Прояснение ожиданий.\n- Зрелое любопытство без «интервью ради интервью»."
        }
      ]
    }
  ],
  "rubric": {
    "criteria": [
      {
        "id": "architecture",
        "name": "Architecture & System Design",
        "description": "Boundaries, масштабирование решений, долгосрочные последствия."
      },
      {
        "id": "technical_depth",
        "name": "Technical Depth (FE / BE specific)",
        "description": "Глубина по направлению: Node.js runtime, async/load/backpressure, data consistency, NestJS internals."
      },
      {
        "id": "decision_making",
        "name": "Decision Making & Trade-offs",
        "description": "Выбор в условиях ограничений и неопределённости, управление рисками."
      },
      {
        "id": "ownership",
        "name": "Ownership & Responsibility",
        "description": "Ответственность за результат, end-to-end владение, реакция на фейлы."
      },
      {
        "id": "production",
        "name": "Production Experience",
        "description": "Инциденты, деградации, мониторинг/observability, постмортемы."
      },
      {
        "id": "communication",
        "name": "Communication & Clarity",
        "description": "Структура мысли, ясность, умение уточнять и объяснять."
      },
      {
        "id": "reflection",
        "name": "Reflection & Learning",
        "description": "Рефлексия, выводы, рост, способность признавать ошибки."
      }
    ],
    "redFlags": [
      "Avoids responsibility",
      "Blames others",
      "Cannot name mistakes",
      "Ignores consequences of decisions",
      "Toxic or rigid communication"
    ]
  }
}
